"use strict";angular.module("foodApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("foodApp").controller("MainCtrl",["$http",function(a){var b=this;b.drinks=[],b.getData=function(){a.get("https://data.cityofboston.gov/resource/hda6-fnsh.json").success(function(a){b.drinkLocations(a),b.getFood()})},b.getFood=function(){a.get("https://data.cityofboston.gov/resource/gb6y-34cq.json").success(function(a){b.drawFood(a)})},b.initialize=function(){var a={center:{lat:42.3601,lng:-71.0589},zoom:14};b.map=new google.maps.Map(document.getElementById("map-canvas"),a),$.getJSON("data/citylimit.topojson",function(a){var c=topojson.feature(a,a.objects.collection);b.map.data.addGeoJson(c)}),b.map.data.setStyle({fillColor:"red",fillOpacity:.06,strokeColor:"red",strokeWeight:1})},b.drawFood=function(a){for(var c,d=0;d<a.length-1;d++){var e=function(){for(var c=0;c<b.drinks.length-1;c++)if(b.drinks[c][0]===Number(a[d].location.latitude)&&b.drinks[c][1]===Number(a[d].location.longitude))return"#0000FF";return"#FF0000"}(),f=new google.maps.Circle({strokeColor:e,strokeOpacity:.8,strokeWeight:2,fillColor:e,fillOpacity:.6,clickable:!0,map:b.map,name:a[d].businessname,address:a[d].address,city:a[d].city,phone:b.formatPhone(a[d].dayphn),center:{lat:Number(a[d].location.latitude),lng:Number(a[d].location.longitude)},radius:10});google.maps.event.addListener(f,"click",function(a){c&&c.close(),c=new google.maps.InfoWindow({content:'<div class="info"><h2>'+this.name+"</h2><h3>"+this.address+", "+this.city+"</h3><h4>Phone: "+this.phone+"</h4></div>"}),c.setPosition(a.latLng),c.open(b.map)})}},b.drinkLocations=function(a){b.drinks=[];for(var c=0;c<a.length-1;c++)"NULL"!==a[c].location&&b.drinks.push([b.getLat(a[c].location),b.getLong(a[c].location)])},b.getLat=function(a){var b=/\(.*,/;return a=b.exec(a)[0],a=a.slice(1),a=a.slice(0,-1),Number(a)},b.getLong=function(a){var b=/\s.*\)/;return a=b.exec(a)[0],a=a.slice(1),a=a.slice(0,-1),Number(a)},b.formatPhone=function(a){return a=a.slice(2),a.substring(0,3)+"-"+a.substring(3,6)+"-"+a.substring(6,a.length)}}]),angular.module("foodApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]);